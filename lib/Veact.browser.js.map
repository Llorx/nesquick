{"version":3,"file":"Veact.browser.js","sources":["../src/VeactState/index.ts","../src/Veact/index.ts"],"sourcesContent":["declare global {\r\n    interface Object {\r\n        val<T>(this:T):VeactState.ReturnReturnType<T>;\r\n    }\r\n}\r\n\r\nexport namespace VeactState {\r\n    export interface Prop {\r\n        proxified:Map<string|number|Symbol, Prop>;\r\n        value:any;\r\n        realValue:any;\r\n        dirty:boolean;\r\n        cbs:Set<Sub>;\r\n        prop:string|number|Symbol;\r\n    }\r\n    export interface Sub {\r\n        oldProps:Set<Prop>;\r\n        props:Set<Prop>;\r\n        animated:boolean;\r\n        cb:() => void;\r\n        prerunning:Sub|null;\r\n        paused:boolean;\r\n        dirty:boolean;\r\n    }\r\n\r\n    export const IS_PROXY = Symbol(\"IS_PROXY\");\r\n    export const GET_VALUE = Symbol(\"GET_VALUE\");\r\n\r\n    let runningSub:Sub|null = null;\r\n    let subs:WeakMap<() => void, Sub> = new WeakMap();\r\n    let animation:number|null = null;\r\n    let subsAnimated:Set<Sub> = new Set();\r\n    let cbsAnimated:Set<() => void> = new Set();\r\n    function runSub(sub:Sub) {\r\n        sub.animated = false;\r\n        sub.oldProps = new Set(sub.props);\r\n        sub.prerunning = runningSub;\r\n        runningSub = sub;\r\n        sub.cb();\r\n        runningSub = sub.prerunning;\r\n        sub.prerunning = null;\r\n        for (let p of sub.oldProps) {\r\n            p.cbs.delete(sub);\r\n            sub.props.delete(p);\r\n            if (p.cbs.size === 0) {\r\n                p.proxified.delete(p.prop);\r\n            }\r\n        }\r\n    }\r\n    function runRender() {\r\n        for (let sub of subsAnimated) {\r\n            subsAnimated.delete(sub);\r\n            runSub(sub);\r\n        }\r\n        for (let cb of cbsAnimated) {\r\n            cbsAnimated.delete(cb);\r\n            cb();\r\n        }\r\n        if (subsAnimated.size > 0) {\r\n            runRender(); // This runs inside requestAnimationFrame tick\r\n        } else {\r\n            animation = null;\r\n        }\r\n    }\r\n    function renderSub(sub:Sub) {\r\n        if (sub.paused) {\r\n            sub.dirty = true;\r\n        } else if (!sub.animated) {\r\n            sub.animated = true;\r\n            subsAnimated.add(sub);\r\n            if (animation === null) {\r\n                animation = requestAnimationFrame(runRender);\r\n            }\r\n        }\r\n    }\r\n    function renderCb(callback:() => void) {\r\n        cbsAnimated.add(callback);\r\n        if (animation === null) {\r\n            animation = requestAnimationFrame(runRender);\r\n        }\r\n    }\r\n\r\n    export function disableSub() {\r\n        let disabledSub = runningSub;\r\n        runningSub = null;\r\n        return disabledSub;\r\n    }\r\n    export function enableSub(sub:Sub|null) { // Always needs to be called after disabling, inside same tick\r\n        runningSub = sub;\r\n    }\r\n\r\n    export function pause(sub:Sub) {\r\n        sub.paused = true;\r\n        if (sub.animated) {\r\n            sub.dirty = true;\r\n            cancelAnimation(sub);\r\n        }\r\n    }\r\n    export function resume(sub:Sub) {\r\n        sub.paused = false;\r\n        if (sub.dirty) {\r\n            sub.dirty = false;\r\n            renderSub(sub);\r\n        }\r\n    }\r\n\r\n    export function draw(callback:() => void) {\r\n        renderCb(callback);\r\n    }\r\n\r\n    export function render(callback:() => void) {\r\n        let sub = subs.get(callback);\r\n        if (!sub) {\r\n            subs.set(callback, sub = {\r\n                oldProps: new Set(),\r\n                props: new Set(),\r\n                animated: false,\r\n                cb: callback,\r\n                prerunning: null,\r\n                paused: false,\r\n                dirty: false\r\n            });\r\n        }\r\n        renderSub(sub);\r\n        return sub;\r\n    }\r\n\r\n    function cancelAnimation(sub:Sub) {\r\n        sub.animated = false;\r\n        subsAnimated.delete(sub);\r\n        if (subsAnimated.size == 0) {\r\n            cancelAnimationFrame(animation as number);\r\n            animation = null;\r\n        }\r\n    }\r\n\r\n    export function cancel(sub:Sub) {\r\n        if (sub.animated) {\r\n            cancelAnimation(sub);\r\n        }\r\n        for (let p of sub.props) {\r\n            p.cbs.delete(sub);\r\n        }\r\n    }\r\n\r\n    const map:WeakMap<any, any> = new WeakMap();\r\n    export function proxy(obj:any) {\r\n        return map.get(obj) || obj;\r\n    }\r\n    export function value(obj:any) {\r\n        return (obj && obj[IS_PROXY]) ? obj[GET_VALUE] : obj; // Not \"obj[GET_VALUE] || obj\" because the returned value can be falsy\r\n    }\r\n\r\n    Object.defineProperties(Function.prototype, {\r\n        val: {\r\n            value() {\r\n                let v = this();\r\n                return v ? v.val() : v;\r\n            },\r\n            enumerable: false\r\n        }\r\n    });\r\n    Object.defineProperties(Object.prototype, {\r\n        val: {\r\n            value() {\r\n                return this\r\n            },\r\n            enumerable: false\r\n        }\r\n    });\r\n    export type ReturnReturnType<T> = T extends (...args:any) => infer R ? ReturnReturnType<R> : T;\r\n\r\n    export function stateNoOptions<T>(st:T) { // To avoid some branching\r\n        if (st && typeof st === \"object\" && !(st as any)[IS_PROXY]) {\r\n            let r = map.get(st);\r\n            if (r) {\r\n                st = r;\r\n            } else {\r\n                let proxified:Map<string|number|Symbol, Prop> = new Map();\r\n                let obj = st;\r\n                st = new Proxy(st as Object, {\r\n                    get: (target, prop) => {\r\n                        if (prop === IS_PROXY) {\r\n                            return true;\r\n                        } else if (prop === GET_VALUE) {\r\n                            return obj;\r\n                        } else {\r\n                            let p = proxified.get(prop);\r\n                            if (!p) {\r\n                                let v = (target as any)[prop];\r\n                                proxified.set(prop, p = {\r\n                                    proxified: proxified,\r\n                                    value: stateNoOptions(v),\r\n                                    realValue: value(v),\r\n                                    dirty: false,\r\n                                    cbs: new Set(),\r\n                                    prop: prop\r\n                                });\r\n                            } else if (p.dirty) {\r\n                                p.dirty = false;\r\n                                p.value = stateNoOptions(p.value);\r\n                            }\r\n                            if (runningSub && !runningSub.oldProps.delete(p)) {\r\n                                p.cbs.add(runningSub);\r\n                                runningSub.props.add(p);\r\n                            }\r\n                            return p.value;\r\n                        }\r\n                    },\r\n                    set: (target, prop, v) => {\r\n                        let p = proxified.get(prop);\r\n                        if (p) {\r\n                            let isProxy = v && v[IS_PROXY];\r\n                            let realValue = isProxy ? v[GET_VALUE] : v;\r\n                            if (p.realValue !== realValue) {\r\n                                (target as any)[prop] = realValue;\r\n                                p.realValue = realValue;\r\n                                p.value = v;\r\n                                if (!isProxy) {\r\n                                    p.dirty = true;\r\n                                }\r\n                                for (let sub of p.cbs) {\r\n                                    renderSub(sub);\r\n                                }\r\n                            }\r\n                        } else {\r\n                            (target as any)[prop] = v;\r\n                        }\r\n                        return true;\r\n                    }\r\n                }) as T;\r\n                map.set(obj, st);\r\n            }\r\n        }\r\n        return st;\r\n    }\r\n\r\n    interface StateOptions<T> {\r\n        saveInterval:number;\r\n    }\r\n    interface StateOptionsLocal<T> extends StateOptions<T> {\r\n        syncKey:string;\r\n        onLoad?(state:T):any;\r\n    }\r\n    interface StateOptionsCustom<T> extends StateOptions<T> {\r\n        load(state:T):any;\r\n        save(state:T):any;\r\n    }\r\n\r\n    function JSONstringify(obj:any, objects:Map<any, any> = new Map()) {\r\n        let res = JSON.stringify(obj, (key, v) => {\r\n            let type = typeof v;\r\n            if (type === \"function\") {\r\n                return undefined;\r\n            }\r\n            return v;\r\n        });\r\n        return res;\r\n    }\r\n    /*function JSONparse<T>(ret:T, obj:any) {\r\n        for (let [k, v] of Object.entries(obj)) {\r\n            if (v && typeof v === \"object\") {\r\n                if (!ret[k]) {\r\n                    ret[k] = Array.isArray(v) ? [] : {};\r\n                }\r\n                JSONparse(ret[k], v);\r\n            } else {\r\n                ret[k] = v;\r\n            }\r\n        }\r\n    }*/\r\n\r\n    export function state<T>(st:T, options?:StateOptionsLocal<T>|StateOptionsCustom<T>) {\r\n        /*let loaded = false;\r\n        if (options) {\r\n            if (\"syncKey\" in options || \"save\" in options) {\r\n                let save = async () => {\r\n                    if (\"syncKey\" in options) {\r\n                        localStorage.setItem(options.syncKey, JSONstringify(ret));\r\n                    }\r\n                    if (\"save\" in options) {\r\n                        options.save(ret);\r\n                    }\r\n                };\r\n                setInterval(save, options.saveInterval);\r\n                window.addEventListener(\"unload\", save);\r\n                if (\"syncKey\" in options) {\r\n                    window.addEventListener(\"storage\", (storage) => {\r\n                        if (storage.key === options.syncKey) {\r\n                            try {\r\n                                JSONparse(ret, JSON.parse(storage.newValue));\r\n                            } catch (e) {}\r\n                        }\r\n                    });\r\n                    try {\r\n                        JSONparse(st, JSON.parse(localStorage.getItem(options.syncKey)));\r\n                        loaded = true;\r\n                    } catch (e) {}\r\n                }\r\n            }\r\n        }*/\r\n        let ret = stateNoOptions(st);\r\n        /*if (options) {\r\n            if (\"load\" in options) {\r\n                options.load(ret);\r\n            }\r\n            if (\"syncKey\" in options && loaded) {\r\n                if (options.onLoad) {\r\n                    options.onLoad(ret);\r\n                }\r\n            }\r\n        }*/\r\n        return ret;\r\n    }\r\n}","import { VeactState } from \"../VeactState\";\r\n\r\nexport { VeactState };\r\nexport namespace Veact {\r\n    export interface Props {\r\n        [k:string]:any;\r\n    }\r\n    interface DynamicOptions<T extends Props> {\r\n        key?:(props:T) => any;\r\n    }\r\n    interface DynamicOptionsProps<T extends Props, TReturn extends Props> extends DynamicOptions<T> {\r\n        props:(props:T) => TReturn;\r\n    }\r\n    type VeactElementConstructor<T = any> = new(props:T extends Props ? T : never, children:Children, type?:keyof JSX.IntrinsicElements) => T extends Props ? VeactElement<T> : VeactElement;\r\n    type DynamicElement = {data:any, i:number|null, element:VeactElement<any>};\r\n    type Dynamic = {constructor:VeactElementConstructor, callback:() => any|any[], options:DynamicOptionsProps<any, Props>|DynamicOptions<any>, children:DynamicElement[], keys:Map<any, DynamicElement>|null};\r\n    const dynamic:WeakMap<VeactElementConstructor[], Dynamic> = new WeakMap();\r\n    export type Sub<T> = T extends {[key:string]:any} ? T extends Array<any> ? T|(() => T) : {[K in keyof T]:T[K]|(() => T[K])} : T|(() => T);\r\n    export type SubAll<T> = T extends {[key:string]:any} ? {[K in keyof T]:SubAll<T[K]>} : T|(() => T);\r\n    export type Children = (string|Node|VeactElement|(() => string|Props|Props[]))[];\r\n    export function createElement<T extends JSX.Props>(type:keyof JSX.IntrinsicElements, props?:T, ...children:Children):VeactElement<T>;\r\n    export function createElement<T extends Props>(type:new(props:T, children:Children) => VeactElement<T>, props?:T, ...children:Children):VeactElement<T>;\r\n    export function createElement<T extends Props>(type:(props:T) => VeactElement<any>, props?:T, ...children:Children):VeactElement<T>;\r\n    export function createElement<T extends Props>(type:keyof JSX.IntrinsicElements|(new(props:T, children:Children) => VeactElement<T>)|((props:T) => VeactElement<any>), props?:T, ...children:Children) {\r\n        if (typeof type === \"string\") {\r\n            return new VeactElement(props, children, type);\r\n        } else if (type.prototype instanceof VeactElement) {\r\n            return new (type as typeof VeactElement)(props, children);\r\n        } else {\r\n            let el = new VeactElement(props, children);\r\n            el.render = type as ((props:T) => VeactElement);\r\n            return el;\r\n        }\r\n    }\r\n    \r\n    export class VeactElement<P extends Props = {}> {\r\n        static for<T extends Props|boolean>(this:VeactElementConstructor<T>, callback:() => T|T[]):VeactElementConstructor<T>[];\r\n        static for<T extends Props|boolean>(this:VeactElementConstructor<T>, callback:() => T|T[], options:T extends Props ? DynamicOptions<T> : undefined):VeactElementConstructor<T>[];\r\n        static for<T extends Props, TReturn extends Props>(this:VeactElementConstructor<TReturn>, callback:() => T|T[], options:DynamicOptionsProps<T, TReturn>):VeactElementConstructor<T>[];\r\n        static for<T extends Props, TReturn extends Props>(this:VeactElementConstructor<TReturn>, callback:() => T|T[], options?:DynamicOptionsProps<T, TReturn>) {\r\n            let list:VeactElementConstructor<TReturn>[] = [];\r\n            dynamic.set(list, {\r\n                constructor: this,\r\n                callback: callback,\r\n                options: options || {},\r\n                children: [],\r\n                keys: (options && options.key) ? new Map() : null\r\n            });\r\n            return list;\r\n        };\r\n        private subs:Set<VeactState.Sub> = new Set();\r\n        private displaySub:VeactState.Sub|null = null;\r\n        private childrenElements:Set<VeactElement> = new Set();\r\n        private visible = true;\r\n        private parent:VeactElement|null = null;\r\n        private destroyed = false;\r\n        private parentVisible = true;\r\n        private _content:Element|null = null;\r\n        private onremove:VeactElement[]|null = null;\r\n        state:{[key:string]:any}|null = null;\r\n        constructor(readonly props?:P, protected readonly children:Children = [], protected readonly type?:keyof JSX.IntrinsicElements) {}\r\n        protected draw(callback:() => void) {\r\n            let sub = VeactState.render(callback);\r\n            this.subs.add(sub);\r\n        }\r\n        private drawDisplay(callback:() => void) {\r\n            this.displaySub = VeactState.render(callback);\r\n        }\r\n        onRemove() {\r\n            this.remove();\r\n        }\r\n        remove() {\r\n            if (this._content && this._content.parentNode) {\r\n                this._content.parentNode.removeChild(this._content);\r\n            }\r\n            if (this.onremove) {\r\n                for (let c of this.onremove) {\r\n                    (c.removed as (()=>void))();\r\n                }\r\n            }\r\n        }\r\n        removed?() {}\r\n        private unsubscribe(onremove:(VeactElement)[] = []) {\r\n            if (this.displaySub) {\r\n                VeactState.cancel(this.displaySub);\r\n            }\r\n            for (let s of this.subs) {\r\n                VeactState.cancel(s);\r\n            }\r\n            for (let c of this.childrenElements) {\r\n                c.unsubscribe(onremove);\r\n            }\r\n            if (this.removed) {\r\n                onremove.push(this);\r\n            }\r\n            return onremove;\r\n        }\r\n        appendTo(el:ParentNode) {\r\n            el.append(this.node);\r\n            return this;\r\n        }\r\n        valueOf() {\r\n            return this.node;\r\n        }\r\n        onRender?() {};\r\n        get node():Element {\r\n            if (!this._content) {\r\n                if (this.state) {\r\n                    this.state = VeactState.state(this.state);\r\n                }\r\n                let sub = VeactState.disableSub();\r\n                let el = this.render(this.props);\r\n                if (el) {\r\n                    this.childrenElements.add(el);\r\n                    el.parent = this;\r\n                    this._content = el.node;\r\n                }\r\n                VeactState.enableSub(sub);\r\n                this.onRender && this.onRender();\r\n            }\r\n            return this._content as Element;\r\n        }\r\n        private pause() {\r\n            for (let sub of this.subs) {\r\n                VeactState.pause(sub);\r\n            }\r\n        }\r\n        private resume() {\r\n            for (let sub of this.subs) {\r\n                VeactState.resume(sub);\r\n            }\r\n        }\r\n        private pauseDisplay() {\r\n            if (this.displaySub) {\r\n                VeactState.pause(this.displaySub);\r\n            }\r\n        }\r\n        private resumeDisplay() {\r\n            if (this.displaySub) {\r\n                VeactState.resume(this.displaySub);\r\n            }\r\n        }\r\n        private setParentVisible(v:boolean) {\r\n            if (this.parentVisible !== v) {\r\n                this.parentVisible = v;\r\n                if (v) {\r\n                    this.resumeDisplay();\r\n                    if (this.visible) {\r\n                        this.resume();\r\n                    }\r\n                } else {\r\n                    if (this.visible) {\r\n                        this.pause();\r\n                    }\r\n                    this.pauseDisplay();\r\n                }\r\n                if (this.visible) {\r\n                    for (let c of this.childrenElements) {\r\n                        c.setParentVisible(v);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        private setVisible(v:boolean) {\r\n            this.visible = v;\r\n            if (this.parentVisible) {\r\n                if (v) {\r\n                    this.resume();\r\n                } else {\r\n                    this.pause();\r\n                }\r\n            }\r\n            for (let c of this.childrenElements) {\r\n                c.setParentVisible(v);\r\n            }\r\n        }\r\n        private setStyle(style:CSSStyleDeclaration, props:Props) {\r\n            for (let [k, v] of Object.entries(props)) {\r\n                if (v instanceof Function) {\r\n                    if (k === \"display\") {\r\n                        this.drawDisplay(((k:any, v:Function) => {\r\n                            let value = v();\r\n                            style[k] = value;\r\n                            let hidden = value === \"none\";\r\n                            if (this.visible === hidden) {\r\n                                this.setVisible(!hidden);\r\n                            }\r\n                        }).bind(this, k, v));\r\n                    } else {\r\n                        this.draw(((k:any, v:Function) => {\r\n                            style[k] = v();\r\n                        }).bind(this, k, v));\r\n                    }\r\n                } else {\r\n                    style[k as any] = v;\r\n                }\r\n            }\r\n        }\r\n        render(props?:P):VeactElement|null {\r\n            let el = document.createElement(this.type as keyof JSX.IntrinsicElements);\r\n            this._content = el;\r\n            if (this.props) {\r\n                for (let [k, v] of Object.entries(this.props)) {\r\n                    if (Array.isArray(v)) {\r\n                        let res:string[] = [];\r\n                        let draws:{i:number, cb:Function}[] = [];\r\n                        for (let i = 0; i < v.length; i++) {\r\n                            let vv = v[i];\r\n                            if (typeof vv === \"function\") {\r\n                                draws.push({\r\n                                    i: i,\r\n                                    cb: vv\r\n                                });\r\n                            } else {\r\n                                res.push(vv)\r\n                            }\r\n                        }\r\n                        if (draws.length) {\r\n                            this.draw(((draws:{i:number, cb:Function}[]) => {\r\n                                for (let v of draws) {\r\n                                    res[v.i] = v.cb();\r\n                                }\r\n                                el.setAttribute(k, (el as any)[k] = res.join(\"\"));\r\n                            }).bind(this, draws));\r\n                        } else {\r\n                            el.setAttribute(k, (el as any)[k] = res.join(\"\"));\r\n                        }\r\n                    } else if (typeof v === \"function\") {\r\n                        if (k.startsWith(\"on\") && k.charCodeAt(2) >= 65 && k.charCodeAt(2) <= 90) {\r\n                            el.addEventListener(k.substring(2).toLowerCase(), v);\r\n                        } else {\r\n                            this.draw(((k:string, v:Function) => {\r\n                                let value = (el as any)[k] = v();\r\n                                if (typeof value === \"string\") {\r\n                                    el.setAttribute(k, value);\r\n                                }/* else if (value === true) { // TODO:?\r\n                                    el.setAttribute(k, \"true\");\r\n                                } else if (value === false) {\r\n                                    el.removeAttribute(k);\r\n                                }*/\r\n                            }).bind(this, k, v));\r\n                        }\r\n                    } else if (k === \"style\") {\r\n                        this.setStyle(el.style, v);\r\n                    } else {\r\n                        (el as any)[k] = v;\r\n                        if (typeof v === \"string\") {\r\n                            el.setAttribute(k, v);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            this.appendChilds(this.children);\r\n            return null;\r\n        }\r\n        private createDynamicChild(data:Props, array:Dynamic) {\r\n            let p:DynamicElement = {\r\n                data: data,\r\n                i: null,\r\n                element: new array.constructor(array.options && \"props\" in array.options ? array.options.props(data) : data, [])\r\n            };\r\n            this.childrenElements.add(p.element); // Duplicated\r\n            p.element.parent = this;\r\n            return p;\r\n        }\r\n        private insertDynamicChild(node:Node, array:Dynamic|null, i:number, childrenData:{node:Node|null}[], pos:number) {\r\n            let next = array && array.children[i+1]; // Duplicated code below\r\n            if (next) {\r\n                (this._content as Element).insertBefore(node, next.element._content);\r\n            } else {\r\n                let next:Node|null = null;\r\n                for (let ii = pos+1; ii < childrenData.length && !next; ii++) {\r\n                    next = childrenData[ii].node;\r\n                }\r\n                if (next) {\r\n                    (this._content as Element).insertBefore(node, next);\r\n                } else {\r\n                    (this._content as Element).appendChild(node);\r\n                }\r\n            }\r\n        }\r\n        private removeChild(el:VeactElement) {\r\n            this.childrenElements.delete(el);\r\n        }\r\n        destroy() {\r\n            if (!this.destroyed) {\r\n                this.destroyed = true;\r\n                this.onremove = this.unsubscribe();\r\n                if (this.parent) {\r\n                    this.parent.removeChild(this);\r\n                }\r\n                this.onRemove();\r\n            }\r\n        }\r\n        protected appendChilds(children:Children) {\r\n            let childrenData:{node:Node|null}[] = []; // Object control to insert childs in creation order\r\n            for (let i = 0; i < children.length; i++) {\r\n                let c = children[i];\r\n                if (c instanceof Function) {\r\n                    let n:{node:Node|null} = {node: null};\r\n                    childrenData[i] = n;\r\n                    ((c, pos) => {\r\n                        let lastRes:Node;\r\n                        this.draw(() => {\r\n                            let res = c() as string;\r\n                            if (lastRes) {\r\n                                lastRes.nodeValue = res;\r\n                            } else {\r\n                                lastRes = document.createTextNode(res);\r\n                                n.node = lastRes;\r\n                                this.insertDynamicChild(lastRes, null, 0, childrenData, pos);\r\n                            }\r\n                        });\r\n                    })(c, i);\r\n                } else if (Array.isArray(c)) {\r\n                    let array = dynamic.get(VeactState.value(c));\r\n                    if (array) {\r\n                        let n:{node:Node|null} = {node: null};\r\n                        childrenData[i] = n;\r\n                        ((c, array, pos) => {\r\n                            this.draw(() => {\r\n                                let res = array.callback() as Props[];\r\n                                if (!Array.isArray(res)) {\r\n                                    res = res ? [res] : [];\r\n                                }\r\n                                let keyf = array.options.key;\r\n                                if (keyf) {\r\n                                    let arrayKeys = array.keys as Map<any, DynamicElement>;\r\n                                    let keys = new Map(arrayKeys);\r\n                                    for (let i = 0; i < res.length; i++) {\r\n                                        let data = res[i];\r\n                                        let key = keyf(data);\r\n                                        let p:DynamicElement;\r\n                                        if (!keys.delete(key)) {\r\n                                            p = this.createDynamicChild(data, array);\r\n                                            array.children.push(p);\r\n                                            arrayKeys.set(key, p);\r\n                                            this.insertDynamicChild(p.element.node, array, array.children.length, childrenData, pos); // PUSH. TODO: Allow ordering when using keys\r\n                                        }\r\n                                    }\r\n                                    for (let [key, p] of keys) {\r\n                                        arrayKeys.delete(key);\r\n                                        let el = p.element;\r\n                                        el.destroy();\r\n                                        (p.element as any) = null; // Clean memory\r\n                                    }\r\n                                    for (let i = 0; i < array.children.length; i++) {\r\n                                        let p = array.children[i];\r\n                                        if (!p.element) {\r\n                                            c.splice(i, 1);\r\n                                            array.children.splice(i--, 1);\r\n                                        } else if (p.i === null) {\r\n                                            c.splice(i, 0, p.element);\r\n                                            p.i = i;\r\n                                        }\r\n                                    }\r\n                                } else {\r\n                                    for (let i = 0; i < res.length; i++) {\r\n                                        let data = res[i];\r\n                                        let p = array.children[i];\r\n                                        if (!p) {\r\n                                            p = this.createDynamicChild(data, array);\r\n                                            c[i] = p.element;\r\n                                            array.children[i] = p;\r\n                                            this.insertDynamicChild(p.element.node, array, i, childrenData, pos);\r\n                                        } else {\r\n                                            if (p.data !== data) {\r\n                                                p.element.destroy();\r\n                                                p.data = data;\r\n                                                p.element = new array.constructor(array.options && \"props\" in array.options ? array.options.props(data) : data, []);\r\n                                                c[i] = p.element;\r\n                                                this.childrenElements.add(p.element);\r\n                                                p.element.parent = this;\r\n                                                this.insertDynamicChild(p.element.node, array, i, childrenData, pos);\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                    if (res.length < array.children.length) {\r\n                                        for (let i = res.length; i < array.children.length; i++) {\r\n                                            let el = array.children[i].element;\r\n                                            el.destroy();\r\n                                        }\r\n                                        array.children.splice(res.length);\r\n                                        c.splice(res.length);\r\n                                    }\r\n                                }\r\n                                n.node = array.children.length > 0 ? array.children[0].element._content : null;\r\n                            });\r\n                        })(c, array, i);\r\n                    } else {\r\n                        childrenData[i] = this.appendChilds(c);\r\n                    }\r\n                } else if (c instanceof VeactElement) {\r\n                    if (!c.destroyed) {\r\n                        this.childrenElements.add(c);\r\n                        c.parent = this;\r\n                        let node = c.node;\r\n                        childrenData[i] = {node:node};\r\n                        (this._content as Element).appendChild(node);\r\n                    } else {\r\n                        childrenData[i] = {node:null};\r\n                    }\r\n                } else if (c != null) {\r\n                    if (!(c instanceof Node)) {\r\n                        c = document.createTextNode(String(c));\r\n                    }\r\n                    childrenData[i] = {node:c};\r\n                    (this._content as Element).appendChild(c);\r\n                }\r\n            }\r\n            return childrenData[0];\r\n        }\r\n    }\r\n    /*class N3SFragment extends N3SElement {\r\n        protected render():N3SElement {\r\n            let el = new DocumentPersistentFragment();\r\n            this.node = el;\r\n            this.appendChilds(this.children);\r\n            return null;\r\n        }\r\n    }*/\r\n}\r\ndeclare global {\r\n    namespace JSX {\r\n        type JSXEvent<T extends Event, T2 extends EventTarget> = T&{currentTarget:T2};\r\n        type JSXHTMLEvent<T extends EventTarget> = {[K in keyof HTMLElementEventMap as `on${Capitalize<K>}`]?:(e:JSXEvent<HTMLElementEventMap[K], T>) => void};\r\n        type JSXSVGEvent<T extends EventTarget> = {[K in keyof SVGElementEventMap as `on${Capitalize<K>}`]?:(e:JSXEvent<SVGElementEventMap[K], T>) => void};\r\n        interface Props<T extends EventTarget = HTMLElement> extends JSXHTMLEvent<T> {\r\n            [k:string]:any;\r\n            style?:StyleProps;\r\n        }\r\n        type StyleProps = {[K in keyof CSSStyleDeclaration]?:CSSStyleDeclaration[K] extends Function ? never : CSSStyleDeclaration[K]|(()=>CSSStyleDeclaration[K])};\r\n        type HTMLProps<T extends HTMLElement = HTMLElement> = Props<T>;\r\n        type SVGProps<T extends SVGElement = SVGElement> = Props<T>;\r\n        type JSXElements = {[K in keyof HTMLElementTagNameMap]:HTMLProps<HTMLElementTagNameMap[K]>}&{[K in keyof SVGElementTagNameMap]:SVGProps<SVGElementTagNameMap[K]>};\r\n\r\n        type Element = Veact.VeactElement;\r\n        //type ElementClass = Veact.VeactElement;\r\n        interface IntrinsicElements extends JSXElements {\r\n            // TODO: fragment\r\n        }\r\n        interface ElementAttributesProperty {\r\n            props: {};\r\n        }\r\n    }\r\n}"],"names":["VeactState","Veact"],"mappings":"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"}